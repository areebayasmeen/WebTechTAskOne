<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Single-Page CRUD App (jQuery + REST API)</title>
  <!-- Bootstrap 5 CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
     <link rel="stylesheet" href="style.css" />
  <style>
    body {
      background-color: #f4f6f9;
      padding: 2rem;
      font-family: 'Segoe UI', sans-serif;
    }

    .main-card {
      background: white;
      border-radius: 12px;
      padding: 20px;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
    }

    .table {
      border-radius: 8px;
      overflow: hidden;
    }

    #loadingOverlay {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0, 0, 0, 0.3);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 1050;
      display: none;
    }

    .header-title {
      font-size: 2rem;
      font-weight: 600;
      margin-bottom: 20px;
    }

    .btn-custom {
      border-radius: 6px;
      padding: 8px 16px;
    }
  </style>
</head>

<body>
    <header>
        <div class="wrapper">
            <span class="logo"><img src="./pictures/image-2.png" alt="ni milaaaaaaaaaaa"></span>
            <ul class="menu">
                <li><a href="./index.html">HOME</a></li>
                <li><a href="./crud.html">API</a></li>
                <li><a href="./cv.html">MY CV</a></li>
                <li><a href="./checkout.html">BUYNOW</a></li>
            </ul>
        </div>
    </header>
  <div id="loadingOverlay">
    <div class="text-center">
      <div class="spinner-border" role="status"><span class="visually-hidden">Loading...</span></div>
      <div class="mt-2">Loading...</div>
    </div>
  </div>

  <!-- Toasts -->
  <div class="position-fixed top-0 end-0 p-3" style="z-index: 2000">
    <div id="toastContainer"></div>
  </div>

  <div class="container">
    <div class="main-card mb-4">
      <h2 class="header-title text-center">Single Page CRUD App</h2>
      <p class="text-center text-muted">Using jQuery, Bootstrap, and JSONPlaceholder API</p>
    </div>

    <div class="row g-4">
      <div class="col-lg-4">
        <div class="main-card">
          <h5 id="formTitle" class="card-title mb-3">Create Post</h5>
          <form id="post-form">
            <input type="hidden" id="postId">
            <div class="mb-3">
              <label class="form-label">Title</label>
              <input type="text" class="form-control" id="postTitle" required>
            </div>
            <div class="mb-3">
              <label class="form-label">Body</label>
              <textarea id="postBody" class="form-control" rows="5" required></textarea>
            </div>
            <div class="d-flex gap-2">
              <button type="submit" id="submitBtn" class="btn btn-primary btn-custom">Create</button>
              <button type="button" id="cancelEditBtn" class="btn btn-secondary btn-custom"
                style="display:none;">Cancel</button>
            </div>
          </form>
        </div>
        <button id="refreshBtn" class="btn btn-outline-primary w-100 mt-3 btn-custom">Refresh List</button>
      </div>

      <div class="col-lg-8">
        <div class="main-card">
          <div class="d-flex justify-content-between align-items-center mb-3">
            <h4>Posts</h4>
            <small class="text-muted">Data from JSONPlaceholder</small>
          </div>

          <div class="table-responsive">
            <table class="table table-bordered table-hover align-middle shadow-sm">
              <thead class="table-dark">
                <tr>
                  <th>ID</th>
                  <th>Title</th>
                  <th>Body</th>
                  <th>Actions</th>
                </tr>
              </thead>
              <tbody id="posts-list"></tbody>
            </table>
          </div>
          <div id="emptyState" class="text-center text-muted mt-3" style="display:none;">No posts to show.</div>
        </div>
      </div>
    </div>
  </div>
  <div class="mb-3">
    <label for="postBody" class="form-label">Body</label>
    <textarea id="postBody" class="form-control" rows="4" required></textarea>
  </div>
  <div class="d-flex gap-2">
    <button type="submit" id="submitBtn" class="btn btn-primary">Create</button>
    <button type="button" id="cancelEditBtn" class="btn btn-secondary" style="display:none;">Cancel</button>
  </div>
  </form>
  </div>
  </div>

  <div class="mt-3">
    <button id="refreshBtn" class="btn btn-outline-primary w-100">Refresh List</button>
  </div>
  </div>

  <div class="col-12 col-lg-8">
    <div class="d-flex justify-content-between align-items-center mb-2">
      <h4 class="m-0">Posts</h4>
      <small class="text-muted">Data from JSONPlaceholder</small>
    </div>

    <div class="table-responsive">
      <table class="table table-bordered table-striped table-hover align-middle shadow-sm rounded">
        <thead class="table-dark">
          <tr>
            <th style="width:6rem">ID</th>
            <th>Title</th>
            <th>Body</th>
            <th style="width:12rem">Actions</th>
          </tr>
        </thead>
        <tbody id="posts-list">
          <!-- content injected here -->
        </tbody>
      </table>
    </div>

    <div id="emptyState" class="text-center text-muted mt-3" style="display:none;">No posts to show.</div>
  </div>
  </div>
  </div>

  <div class="footer"><span class="footer">LOREM</span><span class="footer">VESTIBULUM</span><span
      class="footer">ALIQUAM ETAR</span><span class="footer">CURABITUR</span><span class="footer">INTEGER</span>
  </div>
  <div class="footer1">
    <a href="https://muffingroup.com" target="_blank">Muffin group</a>
    © 2025 Betheme by l
    | All Rights Reserved | Powered by
    <a href="https://wordpress.org" target="_blank">WordPress</a>
  </div>
  <!-- jQuery + Bootstrap JS -->
  <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>

  <script>
    // Configuration
    const API_BASE = 'https://jsonplaceholder.typicode.com'; // free fake REST API
    const RESOURCE = 'posts';

    // UI helpers
    function showLoading(show = true) {
      if (show) $('#loadingOverlay').show(); else $('#loadingOverlay').hide();
    }

    function makeToast(message, isError = false) {
      const id = 'toast' + Date.now();
      const toastHtml = `
        <div id="${id}" class="toast align-items-center text-bg-${isError ? 'danger' : 'success'} border-0 mb-2" role="alert" aria-live="assertive" aria-atomic="true">
          <div class="d-flex">
            <div class="toast-body">
              ${message}
            </div>
            <button type="button" class="btn-close btn-close-white me-2 m-auto" data-bs-dismiss="toast" aria-label="Close"></button>
          </div>
        </div>`;
      $('#toastContainer').append(toastHtml);
      const toastEl = new bootstrap.Toast(document.getElementById(id), { delay: 3500 });
      toastEl.show();
      // remove element after hidden
      document.getElementById(id).addEventListener('hidden.bs.toast', function () { $(this).remove(); });
    }

    // Render helpers
    function renderPostRow(post) {
      // sanitize simple text to avoid HTML injection
      const esc = (s) => $('<div>').text(s).html();
      return `
        <tr data-id="${post.id}">
          <td>${post.id}</td>
          <td class="post-title">${esc(post.title)}</td>
          <td class="post-body">${esc(post.body)}</td>
          <td>
            <button class="btn btn-sm btn-outline-secondary edit-btn">Edit</button>
            <button class="btn btn-sm btn-outline-danger delete-btn">Delete</button>
          </td>
        </tr>`;
    }

    function setFormToCreate() {
      $('#postId').val('');
      $('#postTitle').val('');
      $('#postBody').val('');
      $('#formTitle').text('Create Post');
      $('#submitBtn').text('Create').removeClass('btn-warning').addClass('btn-primary');
      $('#cancelEditBtn').hide();
    }

    function setFormToEdit(post) {
      $('#postId').val(post.id);
      $('#postTitle').val(post.title);
      $('#postBody').val(post.body);
      $('#formTitle').text('Edit Post');
      $('#submitBtn').text('Update').removeClass('btn-primary').addClass('btn-warning');
      $('#cancelEditBtn').show();
    }

    // Load posts
    function loadPosts() {
      showLoading(true);
      $.ajax({
        url: `${API_BASE}/${RESOURCE}`,
        method: 'GET',
        dataType: 'json',
        success(data) {
          // JSONPlaceholder returns 100 posts — show first 15 by default
          const posts = data.slice(0, 15);
          $('#posts-list').empty();
          if (posts.length === 0) $('#emptyState').show(); else $('#emptyState').hide();
          posts.forEach(p => $('#posts-list').append(renderPostRow(p)));
        },
        error() {
          makeToast('Failed to load posts — please check your network.', true);
        },
        complete() { showLoading(false); }
      });
    }

    // Create post
    function createPost(payload) {
      showLoading(true);
      $.ajax({
        url: `${API_BASE}/${RESOURCE}`,
        method: 'POST',
        contentType: 'application/json; charset=UTF-8',
        data: JSON.stringify(payload),
        success(data) {
          // JSONPlaceholder fakes creation and returns an object with id = 101.
          makeToast('Post created');
          // prepend to list for immediate UI feedback
          $('#posts-list').prepend(renderPostRow(data));
          setFormToCreate();
        },
        error() {
          makeToast('Failed to create post', true);
        },
        complete() { showLoading(false); }
      });
    }

    // Update post
    function updatePost(id, payload) {
      showLoading(true);
      $.ajax({
        url: `${API_BASE}/${RESOURCE}/${id}`,
        method: 'PUT',
        contentType: 'application/json; charset=UTF-8',
        data: JSON.stringify(payload),
        success(data) {
          makeToast('Post updated');
          // update row in place
          const row = $(`#posts-list tr[data-id='${id}']`);
          row.find('.post-title').text(data.title);
          row.find('.post-body').text(data.body);
          setFormToCreate();
        },
        error() { makeToast('Failed to update post', true); },
        complete() { showLoading(false); }
      });
    }

    // Delete post
    function deletePost(id) {
      if (!confirm('Are you sure you want to delete this post?')) return;
      showLoading(true);
      $.ajax({
        url: `${API_BASE}/${RESOURCE}/${id}`,
        method: 'DELETE',
        success() {
          makeToast('Post deleted');
          $(`#posts-list tr[data-id='${id}']`).remove();
          if ($('#posts-list tr').length === 0) $('#emptyState').show();
        },
        error() { makeToast('Failed to delete post', true); },
        complete() { showLoading(false); }
      });
    }

    // Document ready
    $(function () {
      // initial state
      setFormToCreate();
      loadPosts();

      // refresh
      $('#refreshBtn').on('click', function () { loadPosts(); });

      // submit form (create or update depending on presence of id)
      $('#post-form').on('submit', function (e) {
        e.preventDefault();
        const id = $('#postId').val().trim();
        const payload = {
          title: $('#postTitle').val().trim(),
          body: $('#postBody').val().trim(),
          userId: 1
        };
        if (!payload.title || !payload.body) { makeToast('Please fill in all fields', true); return; }

        if (id) updatePost(id, payload); else createPost(payload);
      });

      // cancel edit
      $('#cancelEditBtn').on('click', function () { setFormToCreate(); });

      // delegate edit/delete buttons
      $('#posts-list').on('click', '.edit-btn', function () {
        const tr = $(this).closest('tr');
        const id = tr.data('id');
        // prefer to use currently shown content to avoid extra request
        const post = { id: id, title: tr.find('.post-title').text(), body: tr.find('.post-body').text() };
        setFormToEdit(post);
        // scroll form into view on small screens
        $('html, body').animate({ scrollTop: 0 }, 200);
      });

      $('#posts-list').on('click', '.delete-btn', function () {
        const tr = $(this).closest('tr');
        const id = tr.data('id');
        deletePost(id);
      });

    });


  </script>
</body>

</html>